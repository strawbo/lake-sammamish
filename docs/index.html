<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Lake Sammamish Water Temperature</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
        }
        @media screen and (max-width: 768px) {
            h1 {
                font-size: 1.5rem; /* Reduce title size */
            }
            div.chart-container {
                width: 95%;
                max-width: 1000px;
                margin: auto;
                position: relative;
            }
            canvas {
                width: 100% !important;
                height: 400px !important; /* Ensure it doesn't collapse */
            }
        }
    </style>
</head>
<body>
    <h1>Lake Sammamish Water Temperature</h1>
    <div class="chart-container">
        <canvas id="lakeChart"></canvas>
    </div>
    <script>
        const dataCurrent = [{"date":"2025-02-22T00:00:00.000","max_temperature_f":43.4},{"date":"2025-02-23T00:00:00.000","max_temperature_f":44.3},{"date":"2025-02-24T00:00:00.000","max_temperature_f":43.6},{"date":"2025-02-25T00:00:00.000","max_temperature_f":43.4},{"date":"2025-02-26T00:00:00.000","max_temperature_f":44.0},{"date":"2025-02-27T00:00:00.000","max_temperature_f":45.1},{"date":"2025-02-28T00:00:00.000","max_temperature_f":44.9},{"date":"2025-03-01T00:00:00.000","max_temperature_f":46.8},{"date":"2025-03-02T00:00:00.000","max_temperature_f":46.8},{"date":"2025-03-03T00:00:00.000","max_temperature_f":46.8},{"date":"2025-03-04T00:00:00.000","max_temperature_f":46.4},{"date":"2025-03-05T00:00:00.000","max_temperature_f":45.8},{"date":"2025-03-06T00:00:00.000","max_temperature_f":44.7},{"date":"2025-03-07T00:00:00.000","max_temperature_f":46.0},{"date":"2025-03-08T00:00:00.000","max_temperature_f":46.1},{"date":"2025-03-09T00:00:00.000","max_temperature_f":45.7},{"date":"2025-03-10T00:00:00.000","max_temperature_f":44.8},{"date":"2025-03-11T00:00:00.000","max_temperature_f":45.0},{"date":"2025-03-12T00:00:00.000","max_temperature_f":45.7},{"date":"2025-03-13T00:00:00.000","max_temperature_f":45.2},{"date":"2025-03-14T00:00:00.000","max_temperature_f":45.3},{"date":"2025-03-15T00:00:00.000","max_temperature_f":45.2}];
        const dataPast = [{"date":"2023-03-08T00:00:00.000","pYear":2023,"max_temperature_f":43.8},{"date":"2023-03-09T00:00:00.000","pYear":2023,"max_temperature_f":43.3},{"date":"2023-03-10T00:00:00.000","pYear":2023,"max_temperature_f":43.4},{"date":"2023-03-11T00:00:00.000","pYear":2023,"max_temperature_f":43.4},{"date":"2023-03-12T00:00:00.000","pYear":2023,"max_temperature_f":43.8},{"date":"2023-03-13T00:00:00.000","pYear":2023,"max_temperature_f":43.8},{"date":"2023-03-14T00:00:00.000","pYear":2023,"max_temperature_f":44.8},{"date":"2023-03-15T00:00:00.000","pYear":2023,"max_temperature_f":45.3},{"date":"2023-03-16T00:00:00.000","pYear":2023,"max_temperature_f":44.6},{"date":"2023-03-17T00:00:00.000","pYear":2023,"max_temperature_f":45.4},{"date":"2023-03-18T00:00:00.000","pYear":2023,"max_temperature_f":47.6},{"date":"2023-03-19T00:00:00.000","pYear":2023,"max_temperature_f":46.5},{"date":"2023-03-20T00:00:00.000","pYear":2023,"max_temperature_f":45.6},{"date":"2023-03-21T00:00:00.000","pYear":2023,"max_temperature_f":47.0},{"date":"2023-03-22T00:00:00.000","pYear":2023,"max_temperature_f":46.4},{"date":"2024-03-08T00:00:00.000","pYear":2024,"max_temperature_f":46.0},{"date":"2024-03-09T00:00:00.000","pYear":2024,"max_temperature_f":45.7},{"date":"2024-03-10T00:00:00.000","pYear":2024,"max_temperature_f":44.9},{"date":"2024-03-11T00:00:00.000","pYear":2024,"max_temperature_f":45.0},{"date":"2024-03-12T00:00:00.000","pYear":2024,"max_temperature_f":45.2},{"date":"2024-03-13T00:00:00.000","pYear":2024,"max_temperature_f":45.7},{"date":"2024-03-14T00:00:00.000","pYear":2024,"max_temperature_f":45.8},{"date":"2024-03-15T00:00:00.000","pYear":2024,"max_temperature_f":46.7},{"date":"2024-03-16T00:00:00.000","pYear":2024,"max_temperature_f":47.7},{"date":"2024-03-17T00:00:00.000","pYear":2024,"max_temperature_f":50.2},{"date":"2024-03-18T00:00:00.000","pYear":2024,"max_temperature_f":50.5},{"date":"2024-03-19T00:00:00.000","pYear":2024,"max_temperature_f":52.8},{"date":"2024-03-20T00:00:00.000","pYear":2024,"max_temperature_f":52.2},{"date":"2024-03-21T00:00:00.000","pYear":2024,"max_temperature_f":50.8},{"date":"2024-03-22T00:00:00.000","pYear":2024,"max_temperature_f":50.8}];

        
const datasets = [
    {
        label: "Current Year",
        data: dataCurrent.map(row => ({ x: new Date(row.date), y: row.max_temperature_f })),
        borderColor: "rgba(75, 192, 192, 1)",
        backgroundColor: "rgba(75, 192, 192, 0.2)",
        fill: false,
        borderWidth: 5, // Make current year thicker
        tension: 0.1
    }
];

const colors = ["rgba(192, 75, 75, 1)", "rgba(192, 192, 75, 1)", "rgba(75, 75, 192, 1)", "rgba(192, 75, 192, 1)", "rgba(75, 192, 75, 1)"];
let colorIndex = 0;

const years = Array.from(new Set(dataPast.map(row => Math.round(row.pYear))));  // Remove decimal

years.forEach(year => {
    const filteredData = dataPast.filter(item => item.pYear === year);
    datasets.push({
        label: `${year}`,  // Fixing label formatting
        data: filteredData.map(row => {
           let pastDate = new Date(row.date);
           pastDate.setFullYear(new Date().getFullYear());  // Normalize the year to current
           return { x: pastDate, y: row.max_temperature_f };
       }),
       borderColor: colors[colorIndex % colors.length],
        borderWidth: 2,
        borderDash: [5, 5], // Dashed lines for previous years
        fill: false,
        tension: 0.1
    });
    colorIndex++;
});

        const ctx = document.getElementById("lakeChart").getContext("2d");

        new Chart(ctx, {
            type: "line",
            data: {
                datasets: datasets
            },
            options: {
                responsive: true,  // Make it scale to different screens
                maintainAspectRatio: false,  // Allow dynamic resizing
                aspectRatio: 2,  // Ensure it doesn't get too tall
                scales: {
                    x: {
                        type: "time",
                        time: {
                            unit: "day",
                            tooltipFormat: "MMM d",
                            displayFormats: {
                                day: "MMM d"
                            }
                        },
                        title: {
                            display: true,
                            text: "Date"
                        },
                        min: new Date(new Date().setDate(new Date().getDate() - 7)),  // 7 days before today
                        max: new Date(new Date().setDate(new Date().getDate() + 7))   // 7 days after today
                    },
                    y: {
                        suggestedMin: 40,
                        suggestedMax: 90,
                        title: {
                            display: true,
                            text: "Temperature (Â°F)"
                        }
                    }
                }
            }
        });
    </script>
</body>
</html>